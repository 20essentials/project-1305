import{$ as _t}from"./functions.DyxYIT6y.js";var m={image:new Map,background:new Map,resource:new Map,defaultStyle:new Map,baseStyle:new Map,computedStyle:new WeakMap,font:new Set,session:{styleMap:new Map,styleCache:new WeakMap,nodeMap:new Map}};function Wt(t="soft"){switch(t){case"auto":{m.session.styleMap=new Map,m.session.nodeMap=new Map;return}case"soft":{m.session.styleMap=new Map,m.session.nodeMap=new Map,m.session.styleCache=new WeakMap;return}case"full":return;case"disabled":{m.session.styleMap=new Map,m.session.nodeMap=new Map,m.session.styleCache=new WeakMap,m.computedStyle=new WeakMap,m.baseStyle=new Map,m.defaultStyle=new Map,m.image=new Map,m.background=new Map,m.resource=new Map,m.font=new Set;return}default:{m.session.styleMap=new Map,m.session.nodeMap=new Map,m.session.styleCache=new WeakMap;return}}}function ht(t){const e=t.match(/url\((['"]?)(.*?)(\1)\)/);if(!e)return null;const n=e[2].trim();return n.startsWith("#")?null:n}function Ot(t){if(!t||t==="none")return"";let e=t.replace(/translate[XY]?\([^)]*\)/g,"");return e=e.replace(/matrix\(([^)]+)\)/g,(n,o)=>{const r=o.split(",").map(i=>i.trim());return r.length!==6?`matrix(${o})`:(r[4]="0",r[5]="0",`matrix(${r.join(", ")})`)}),e=e.replace(/matrix3d\(([^)]+)\)/g,(n,o)=>{const r=o.split(",").map(i=>i.trim());return r.length!==16?`matrix3d(${o})`:(r[12]="0",r[13]="0",`matrix3d(${r.join(", ")})`)}),e.trim().replace(/\s{2,}/g," ")}function vt(t){if(/%[0-9A-Fa-f]{2}/.test(t))return t;try{return encodeURI(t)}catch{return t}}function Ut(t="[snapDOM]",{ttlMs:e=5*6e4,maxEntries:n=12}={}){const o=new Map;let r=0;function i(a,s,u){if(r>=n)return;const c=Date.now();(o.get(s)||0)>c||(o.set(s,c+e),r++,a==="warn"&&console&&console.warn?console.warn(`${t} ${u}`):console&&console.error&&console.error(`${t} ${u}`))}return{warnOnce(a,s){i("warn",a,s)},errorOnce(a,s){i("error",a,s)},reset(){o.clear(),r=0}}}var wt=Ut("[snapDOM]",{ttlMs:3*6e4,maxEntries:10}),at=new Map,Z=new Map;function Bt(t){return/^data:|^blob:|^about:blank$/.test(t)}function Dt(t,e){if(!e||Bt(t))return!1;try{const n=typeof location<"u"&&location.href?location.href:"http://localhost/",o=new URL(t,n);return typeof location<"u"?o.origin!==location.origin:!0}catch{return!!e}}function qt(t,e){if(!e)return t;if(e.includes("{url}"))return e.replace("{url}",encodeURIComponent(t));const n=e.endsWith("?")?"":e.includes("?")?"&":"?";return`${e}${n}url=${encodeURIComponent(t)}`}function jt(t){return new Promise((e,n)=>{const o=new FileReader;o.onload=()=>e(String(o.result||"")),o.onerror=()=>n(new Error("read_failed")),o.readAsDataURL(t)})}function Ht(t,e){return[e.as||"blob",e.timeout??3e3,e.useProxy||"",e.errorTTL??8e3,t].join("|")}async function z(t,e={}){const n=e.as??"blob",o=e.timeout??3e3,r=e.useProxy||"",i=e.errorTTL??8e3,a=e.headers||{},s=!!e.silent,u=Ht(t,{as:n,timeout:o,useProxy:r,errorTTL:i}),c=Z.get(u);if(c&&c.until>Date.now())return{...c.result,fromCache:!0};c&&Z.delete(u);const l=at.get(u);if(l)return l;const d=Dt(t,r)?qt(t,r):t;let x=e.credentials;if(!x)try{const w=typeof location<"u"&&location.href?location.href:"http://localhost/",L=new URL(t,w);x=typeof location<"u"&&L.origin===location.origin?"include":"omit"}catch{x="omit"}const N=new AbortController,C=setTimeout(()=>N.abort("timeout"),o),$=(async()=>{try{const w=await fetch(d,{signal:N.signal,credentials:x,headers:a});if(!w.ok){const T={ok:!1,data:null,status:w.status,url:d,fromCache:!1,reason:"http_error"};if(Z.set(u,{until:Date.now()+i,result:T}),!s){const _=`${w.status} ${w.statusText||""}`.trim();wt.warnOnce(`http:${w.status}:${n}:${new URL(t,location?.href??"http://localhost/").origin}`,`HTTP error ${_} while fetching ${n} ${t}`)}return e.onError&&e.onError(T),T}if(n==="text")return{ok:!0,data:await w.text(),status:w.status,url:d,fromCache:!1};const L=await w.blob(),E=L.type||w.headers.get("content-type")||"";return n==="dataURL"?{ok:!0,data:await jt(L),status:w.status,url:d,fromCache:!1,mime:E}:{ok:!0,data:L,status:w.status,url:d,fromCache:!1,mime:E}}catch(w){const L=w&&typeof w=="object"&&"name"in w&&w.name==="AbortError"?String(w.message||"").includes("timeout")?"timeout":"abort":"network",E={ok:!1,data:null,status:0,url:d,fromCache:!1,reason:L};if(Z.set(u,{until:Date.now()+i,result:E}),!s){const T=`${L}:${n}:${new URL(t,location?.href??"http://localhost/").origin}`,_=L==="timeout"?`Timeout after ${o}ms. Consider increasing timeout or using a proxy for ${t}`:L==="abort"?`Request aborted while fetching ${n} ${t}`:`Network/CORS issue while fetching ${n} ${t}. A proxy may be required`;wt.errorOnce(T,_)}return e.onError&&e.onError(E),E}finally{clearTimeout(C),at.delete(u)}})();return at.set(u,$),$}function mt(t,e){if(!e||!t.width||!t.height)return t;const n=document.createElement("canvas");n.width=t.width,n.height=t.height;const o=n.getContext("2d");return o.fillStyle=e,o.fillRect(0,0,n.width,n.height),o.drawImage(t,0,0),n}async function At(t,e={}){if(/^((repeating-)?(linear|radial|conic)-gradient)\(/i.test(t)||t.trim()==="none")return t;const o=ht(t);if(!o)return t;const r=vt(o);if(m.background.has(r)){const i=m.background.get(r);return i?`url("${i}")`:"none"}try{const i=await z(r,{as:"dataURL",useProxy:e.useProxy});return i.ok?(m.background.set(r,i.data),`url("${i.data}")`):(m.background.set(r,null),"none")}catch{return m.background.set(r,null),"none"}}var zt=new Set(["meta","script","noscript","title","link","template"]),pt=new Set(["meta","link","style","title","noscript","script","template","g","defs","use","marker","mask","clipPath","pattern","path","polygon","polyline","line","circle","ellipse","rect","filter","lineargradient","radialgradient","stop"]);function Vt(t){if(t=String(t).toLowerCase(),pt.has(t)){const i={};return m.defaultStyle.set(t,i),i}if(m.defaultStyle.has(t))return m.defaultStyle.get(t);let e=document.getElementById("snapdom-sandbox");e||(e=document.createElement("div"),e.id="snapdom-sandbox",e.setAttribute("data-snapdom-sandbox","true"),e.setAttribute("aria-hidden","true"),e.style.position="absolute",e.style.left="-9999px",e.style.top="-9999px",e.style.width="0px",e.style.height="0px",e.style.overflow="hidden",document.body.appendChild(e));const n=document.createElement(t);n.style.all="initial",e.appendChild(n);const o=getComputedStyle(n),r={};for(let i of o){if(Et(i))continue;const a=o.getPropertyValue(i);r[i]=a}return e.removeChild(n),m.defaultStyle.set(t,r),r}var Xt=/(?:^|-)(animation|transition)(?:-|$)/i,Kt=/^(--|view-timeline|scroll-timeline|animation-trigger|offset-|position-try|app-region|interactivity|overlay|view-transition|-webkit-locale|-webkit-user-(?:drag|modify)|-webkit-tap-highlight-color|-webkit-text-security)$/i,Yt=new Set(["cursor","pointer-events","touch-action","user-select","print-color-adjust","speak","reading-flow","reading-order","anchor-name","anchor-scope","container-name","container-type","timeline-scope"]);function Et(t){const e=String(t).toLowerCase();return!!(Yt.has(e)||Kt.test(e)||Xt.test(e))}function ct(t,e){if(e=String(e||"").toLowerCase(),pt.has(e))return"";const n=[],o=Vt(e);for(let[r,i]of Object.entries(t)){if(Et(r))continue;const a=o[r];i&&i!==a&&n.push(`${r}:${i}`)}return n.sort(),n.join(";")}function Gt(t){const e=new Set;return t.nodeType!==Node.ELEMENT_NODE&&t.nodeType!==Node.DOCUMENT_FRAGMENT_NODE?[]:(t.tagName&&e.add(t.tagName.toLowerCase()),typeof t.querySelectorAll=="function"&&t.querySelectorAll("*").forEach(n=>e.add(n.tagName.toLowerCase())),Array.from(e))}function Jt(t){const e=new Map;for(let o of t){const r=m.defaultStyle.get(o);if(!r)continue;const i=Object.entries(r).map(([a,s])=>`${a}:${s};`).sort().join("");i&&(e.has(i)||e.set(i,[]),e.get(i).push(o))}let n="";for(let[o,r]of e.entries())n+=`${r.join(",")} { ${o} }
`;return n}function Zt(t){const e=Array.from(new Set(t.values())).filter(Boolean).sort(),n=new Map;let o=1;for(const r of e)n.set(r,`c${o++}`);return n}function Mt(t,e=null){if(!(t instanceof Element))return window.getComputedStyle(t,e);let n=m.computedStyle.get(t);if(n||(n=new Map,m.computedStyle.set(t,n)),!n.has(e)){const o=window.getComputedStyle(t,e);n.set(e,o)}return n.get(e)}function Qt(t){let e=t.replace(/^['"]|['"]$/g,"");if(e.startsWith("\\"))try{return String.fromCharCode(parseInt(e.replace("\\",""),16))}catch{return e}return e}function bt(t){const e={};for(let n of t)e[n]=t.getPropertyValue(n);return e}function Lt(t){const e=[];let n=0,o=0;for(let r=0;r<t.length;r++){const i=t[r];i==="("&&n++,i===")"&&n--,i===","&&n===0&&(e.push(t.slice(o,r).trim()),o=r+1)}return e.push(t.slice(o).trim()),e}function X(t,{fast:e=!1}={}){if(e)return t();"requestIdleCallback"in window?requestIdleCallback(t,{timeout:50}):setTimeout(t,1)}function Rt(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}var St=new WeakMap,lt=new Map,ut=0;function G(){ut++}var xt=!1;function te(t=document.documentElement){if(!xt){xt=!0;try{new MutationObserver(()=>G()).observe(t,{subtree:!0,childList:!0,characterData:!0,attributes:!0})}catch{}try{new MutationObserver(()=>G()).observe(document.head,{subtree:!0,childList:!0,characterData:!0,attributes:!0})}catch{}try{const e=document.fonts;e&&(e.addEventListener?.("loadingdone",G),e.ready?.then(()=>G()).catch(()=>{}))}catch{}}}function ee(t){const e={},n=t.getPropertyValue("visibility");for(let o=0;o<t.length;o++){const r=t[o];let i=t.getPropertyValue(r);(r==="background-image"||r==="content")&&i.includes("url(")&&!i.includes("data:")&&(i="none"),e[r]=i}return n==="hidden"&&(e.opacity="0"),e}var Ct=new WeakMap;function ne(t){let e=Ct.get(t);return e||(e=Object.entries(t).sort((o,r)=>o[0]<r[0]?-1:o[0]>r[0]?1:0).map(([o,r])=>`${o}:${r}`).join(";"),Ct.set(t,e),e)}function oe(t,e=null){const n=St.get(t);if(n&&n.epoch===ut)return n.snapshot;const o=e||getComputedStyle(t),r=ee(o);return St.set(t,{epoch:ut,snapshot:r}),r}function re(t,e){return t&&t.session&&t.persist?t:t&&(t.styleMap||t.styleCache||t.nodeMap)?{session:t,persist:{snapshotKeyCache:lt,defaultStyle:m.defaultStyle,baseStyle:m.baseStyle,image:m.image,resource:m.resource,background:m.background,font:m.font},options:e||{}}:{session:m.session,persist:{snapshotKeyCache:lt,defaultStyle:m.defaultStyle,baseStyle:m.baseStyle,image:m.image,resource:m.resource,background:m.background,font:m.font},options:t||e||{}}}async function K(t,e,n,o){if(t.tagName==="STYLE")return;const r=re(n,o),i=r.options&&r.options.cache||"auto";if(i!=="disabled"&&te(document.documentElement),i==="disabled"&&!r.session.__bumpedForDisabled&&(G(),lt.clear(),r.session.__bumpedForDisabled=!0),pt.has(t.tagName?.toLowerCase())){const x=t.getAttribute?.("style");x&&e.setAttribute("style",x)}const{session:a,persist:s}=r;a.styleCache.has(t)||a.styleCache.set(t,getComputedStyle(t));const u=a.styleCache.get(t),c=oe(t,u),l=ne(c);let d=s.snapshotKeyCache.get(l);if(!d){const x=t.tagName?.toLowerCase()||"div";d=ct(c,x),s.snapshotKeyCache.set(l,d)}a.styleMap.set(e,d)}function st(t,e,n){return Promise.all(t.map(o=>new Promise(r=>{function i(){X(a=>{(a&&typeof a.timeRemaining=="function"?a.timeRemaining()>0:!0)?e(o,r):i()},{fast:n})}i()})))}function ae(t){return t=t.trim(),!t||/\:not\(\s*\[data-sd-slotted\]\s*\)\s*$/.test(t)?t:`${t}:not([data-sd-slotted])`}function se(t,e,n=!0){return t.split(",").map(o=>o.trim()).filter(Boolean).map(o=>{if(o.startsWith(":where(")||o.startsWith("@"))return o;const r=n?ae(o):o;return`:where(${e} ${r})`}).join(", ")}function ie(t,e){return t?(t=t.replace(/:host\(([^)]+)\)/g,(n,o)=>`:where(${e}:is(${o.trim()}))`),t=t.replace(/:host\b/g,`:where(${e})`),t=t.replace(/:host-context\(([^)]+)\)/g,(n,o)=>`:where(:where(${o.trim()}) ${e})`),t=t.replace(/::slotted\(([^)]+)\)/g,(n,o)=>`:where(${e} ${o.trim()})`),t=t.replace(/(^|})(\s*)([^@}{]+){/g,(n,o,r,i)=>{const a=se(i,e,!0);return`${o}${r}${a}{`}),t):""}function ce(t){return t.shadowScopeSeq=(t.shadowScopeSeq||0)+1,`s${t.shadowScopeSeq}`}function le(t){let e="";try{t.querySelectorAll("style").forEach(o=>{e+=(o.textContent||"")+`
`});const n=t.adoptedStyleSheets||[];for(const o of n)try{if(o&&o.cssRules)for(const r of o.cssRules)e+=r.cssText+`
`}catch{}}catch{}return e}function ue(t,e,n){if(!e)return;const o=document.createElement("style");o.setAttribute("data-sd",n),o.textContent=e,t.insertBefore(o,t.firstChild||null)}function fe(t,e){try{const n=t.currentSrc||t.src||"";if(!n)return;e.setAttribute("src",n),e.removeAttribute("srcset"),e.removeAttribute("sizes"),e.loading="eager",e.decoding="sync"}catch{}}function de(t){const e=new Set;if(!t)return e;const n=/var\(\s*(--[A-Za-z0-9_-]+)\b/g;let o;for(;o=n.exec(t);)e.add(o[1]);return e}function he(t,e){try{let o=getComputedStyle(t).getPropertyValue(e).trim();if(o)return o}catch{}try{let o=getComputedStyle(document.documentElement).getPropertyValue(e).trim();if(o)return o}catch{}return""}function me(t,e,n){const o=[];for(const r of e){const i=he(t,r);i&&o.push(`${r}: ${i};`)}return o.length?`${n}{${o.join("")}}
`:""}function pe(t){t&&(t.nodeType===Node.ELEMENT_NODE&&t.setAttribute("data-sd-slotted",""),t.querySelectorAll&&t.querySelectorAll("*").forEach(e=>e.setAttribute("data-sd-slotted","")))}async function ge(t,e=3){const n=()=>{try{return t.contentDocument||t.contentWindow?.document||null}catch{return null}};let o=n(),r=0;for(;r<e&&(!o||!o.body&&!o.documentElement);)await new Promise(i=>setTimeout(i,0)),o=n(),r++;return o&&(o.body||o.documentElement)?o:null}function ye(t){const e=t.getBoundingClientRect();let n=0,o=0,r=0,i=0;try{const u=getComputedStyle(t);n=parseFloat(u.borderLeftWidth)||0,o=parseFloat(u.borderRightWidth)||0,r=parseFloat(u.borderTopWidth)||0,i=parseFloat(u.borderBottomWidth)||0}catch{}const a=Math.max(0,Math.round(e.width-(n+o))),s=Math.max(0,Math.round(e.height-(r+i)));return{contentWidth:a,contentHeight:s,rect:e}}function we(t,e,n){const o=t.createElement("style");return o.setAttribute("data-sd-iframe-pin",""),o.textContent=`html, body {margin: 0 !important;padding: 0 !important;width: ${e}px !important;height: ${n}px !important;min-width: ${e}px !important;min-height: ${n}px !important;box-sizing: border-box !important;overflow: hidden !important;background-clip: border-box !important;}`,(t.head||t.documentElement).appendChild(o),()=>{try{o.remove()}catch{}}}async function be(t,e,n){const o=await ge(t,3);if(!o)throw new Error("iframe document not accessible/ready");const{contentWidth:r,contentHeight:i,rect:a}=ye(t),s=n?.snap;if(!s||typeof s.toPng!="function")throw new Error("snapdom.toPng not available in iframe or window");const u={...n,scale:1},c=we(o,r,i);let l;try{l=await s.toPng(o.documentElement,u)}finally{c()}l.style.display="block",l.style.width=`${r}px`,l.style.height=`${i}px`;const d=document.createElement("div");return e.nodeMap.set(d,t),K(t,d,e,n),d.style.overflow="hidden",d.style.display="block",d.style.width||(d.style.width=`${Math.round(a.width)}px`),d.style.height||(d.style.height=`${Math.round(a.height)}px`),d.appendChild(l),d}async function tt(t,e,n){if(!t)throw new Error("Invalid node");const o=new Set;let r=null,i=null;if(t.nodeType===Node.ELEMENT_NODE){const c=(t.localName||t.tagName||"").toLowerCase();if(t.id==="snapdom-sandbox"||t.hasAttribute("data-snapdom-sandbox")||zt.has(c))return null}if(t.nodeType===Node.TEXT_NODE||t.nodeType!==Node.ELEMENT_NODE)return t.cloneNode(!0);if(t.getAttribute("data-capture")==="exclude"){const c=document.createElement("div"),l=t.getBoundingClientRect();return c.style.cssText=`display:inline-block;width:${l.width}px;height:${l.height}px;visibility:hidden;`,c}if(n.exclude&&Array.isArray(n.exclude))for(const c of n.exclude)try{if(t.matches?.(c)){const l=document.createElement("div"),d=t.getBoundingClientRect();return l.style.cssText=`display:inline-block;width:${d.width}px;height:${d.height}px;visibility:hidden;`,l}}catch(l){console.warn(`Invalid selector in exclude option: ${c}`,l)}if(typeof n.filter=="function")try{if(!n.filter(t)){const c=document.createElement("div"),l=t.getBoundingClientRect();return c.style.cssText=`display:inline-block;width:${l.width}px;height:${l.height}px;visibility:hidden;`,c}}catch(c){console.warn("Error in filter function:",c)}if(t.tagName==="IFRAME"){let c=!1;try{c=!!(t.contentDocument||t.contentWindow?.document)}catch{c=!1}if(c)try{return await be(t,e,n)}catch(l){console.warn("[SnapDOM] iframe rasterization failed, fallback:",l)}if(n.placeholders){const l=document.createElement("div");return l.style.cssText=`width:${t.offsetWidth}px;height:${t.offsetHeight}px;background-image:repeating-linear-gradient(45deg,#ddd,#ddd 5px,#f9f9f9 5px,#f9f9f9 10px);display:flex;align-items:center;justify-content:center;font-size:12px;color:#555;border:1px solid #aaa;`,K(t,l,e,n),l}else{const l=t.getBoundingClientRect(),d=document.createElement("div");return d.style.cssText=`display:inline-block;width:${l.width}px;height:${l.height}px;visibility:hidden;`,K(t,d,e,n),d}}if(t.getAttribute("data-capture")==="placeholder"){const c=t.cloneNode(!1);e.nodeMap.set(c,t),K(t,c,e,n);const l=document.createElement("div");return l.textContent=t.getAttribute("data-placeholder-text")||"",l.style.cssText="color:#666;font-size:12px;text-align:center;line-height:1.4;padding:0.5em;box-sizing:border-box;",c.appendChild(l),c}if(t.tagName==="CANVAS"){const c=t.toDataURL(),l=document.createElement("img");return l.src=c,l.width=t.width,l.height=t.height,e.nodeMap.set(l,t),K(t,l,e,n),l}let a;try{if(a=t.cloneNode(!1),e.nodeMap.set(a,t),t.tagName==="IMG"){fe(t,a);try{const c=t.getBoundingClientRect();let l=Math.round(c.width||0),d=Math.round(c.height||0);if(!l||!d){const x=window.getComputedStyle(t),N=parseFloat(x.width)||0,C=parseFloat(x.height)||0,$=parseInt(t.getAttribute("width")||"",10)||0,w=parseInt(t.getAttribute("height")||"",10)||0,L=t.width||t.naturalWidth||0,E=t.height||t.naturalHeight||0;l=Math.round(l||N||$||L||0),d=Math.round(d||C||w||E||0)}l&&(a.dataset.snapdomWidth=String(l)),d&&(a.dataset.snapdomHeight=String(d))}catch{}}}catch(c){throw console.error("[Snapdom] Failed to clone node:",t,c),c}if(t instanceof HTMLTextAreaElement){const c=t.getBoundingClientRect();a.style.width=`${c.width}px`,a.style.height=`${c.height}px`}if(t instanceof HTMLInputElement&&(a.value=t.value,a.setAttribute("value",t.value),t.checked!==void 0&&(a.checked=t.checked,t.checked&&a.setAttribute("checked",""),t.indeterminate&&(a.indeterminate=t.indeterminate))),t instanceof HTMLSelectElement&&(r=t.value),t instanceof HTMLTextAreaElement&&(i=t.value),K(t,a,e,n),t.shadowRoot){let c=function(E,T){if(E.nodeType===Node.ELEMENT_NODE&&E.tagName==="STYLE")return T(null);tt(E,e,n).then(_=>{T(_||null)}).catch(_=>{T(null)})};try{const E=t.shadowRoot.querySelectorAll("slot");for(const T of E){let _=[];try{_=T.assignedNodes?.({flatten:!0})||T.assignedNodes?.()||[]}catch{_=T.assignedNodes?.()||[]}for(const D of _)o.add(D)}}catch{}const l=ce(e),d=`[data-sd="${l}"]`;try{a.setAttribute("data-sd",l)}catch{}const x=le(t.shadowRoot),N=ie(x,d),C=de(x),$=me(t,C,d);ue(a,$+N,l);const w=document.createDocumentFragment(),L=await st(Array.from(t.shadowRoot.childNodes),c,n.fast);w.append(...L.filter(E=>!!E)),a.appendChild(w)}if(t.tagName==="SLOT"){let c=function(C,$){tt(C,e,n).then(w=>{w&&pe(w),$(w||null)}).catch(w=>{$(null)})};const l=t.assignedNodes?.({flatten:!0})||[],d=l.length>0?l:Array.from(t.childNodes),x=document.createDocumentFragment(),N=await st(Array.from(d),c,n.fast);return x.append(...N.filter(C=>!!C)),x}function s(c,l){if(o.has(c))return l(null);tt(c,e,n).then(d=>{l(d||null)}).catch(d=>{l(null)})}const u=await st(Array.from(t.childNodes),s,n.fast);if(a.append(...u.filter(c=>!!c)),r!==null&&a instanceof HTMLSelectElement){a.value=r;for(const c of a.options)c.value===r?c.setAttribute("selected",""):c.removeAttribute("selected")}return i!==null&&a instanceof HTMLTextAreaElement&&(a.textContent=i),a}var Se=[/font\s*awesome/i,/material\s*icons/i,/ionicons/i,/glyphicons/i,/feather/i,/bootstrap\s*icons/i,/remix\s*icons/i,/heroicons/i,/layui/i,/lucide/i],ft=[];function xe(t){const e=Array.isArray(t)?t:[t];for(const n of e)n instanceof RegExp?ft.push(n):typeof n=="string"?ft.push(new RegExp(n,"i")):console.warn("[snapdom] Ignored invalid iconFont value:",n)}function H(t){const e=typeof t=="string"?t:"",n=[...Se,...ft];for(const o of n)if(o instanceof RegExp&&o.test(e))return!0;return!!(/icon/i.test(e)||/glyph/i.test(e)||/symbols/i.test(e)||/feather/i.test(e)||/fontawesome/i.test(e))}async function Ce(t,e,n,o=32,r="#000"){e=e.replace(/^['"]+|['"]+$/g,"");const i=window.devicePixelRatio||1;await document.fonts.ready;const a=document.createElement("span");a.textContent=t,a.style.position="absolute",a.style.visibility="hidden",a.style.fontFamily=`"${e}"`,a.style.fontWeight=n||"normal",a.style.fontSize=`${o}px`,a.style.lineHeight="1",a.style.whiteSpace="nowrap",a.style.padding="0",a.style.margin="0",document.body.appendChild(a);const s=a.getBoundingClientRect(),u=Math.ceil(s.width),c=Math.ceil(s.height);document.body.removeChild(a);const l=document.createElement("canvas");l.width=u*i,l.height=c*i;const d=l.getContext("2d");return d.scale(i,i),d.font=n?`${n} ${o}px "${e}"`:`${o}px "${e}"`,d.textAlign="left",d.textBaseline="top",d.fillStyle=r,d.fillText(t,0,0),{dataUrl:l.toDataURL(),width:u,height:c}}var $e=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","emoji","math","fangsong","ui-serif","ui-sans-serif","ui-monospace","ui-rounded"]);function et(t){if(!t)return"";for(let e of t.split(",")){let n=e.trim().replace(/^['"]+|['"]+$/g,"");if(n&&!$e.has(n.toLowerCase()))return n}return""}function nt(t){const e=String(t??"400").trim().toLowerCase();if(e==="normal")return 400;if(e==="bold")return 700;const n=parseInt(e,10);return Number.isFinite(n)?Math.min(900,Math.max(100,n)):400}function dt(t){const e=String(t??"normal").trim().toLowerCase();return e.startsWith("italic")?"italic":e.startsWith("oblique")?"oblique":"normal"}function ke(t){const e=String(t??"100%").match(/(\d+(?:\.\d+)?)\s*%/);return e?Math.max(50,Math.min(200,parseFloat(e[1]))):100}function ve(t){const e=String(t||"400").trim(),n=e.match(/^(\d{2,3})\s+(\d{2,3})$/);if(n){const r=nt(n[1]),i=nt(n[2]);return{min:Math.min(r,i),max:Math.max(r,i)}}const o=nt(e);return{min:o,max:o}}function Ae(t){const e=String(t||"normal").trim().toLowerCase();return e==="italic"?{kind:"italic"}:e.startsWith("oblique")?{kind:"oblique"}:{kind:"normal"}}function Ee(t){const e=String(t||"100%").trim(),n=e.match(/(\d+(?:\.\d+)?)\s*%\s+(\d+(?:\.\d+)?)\s*%/);if(n){const i=parseFloat(n[1]),a=parseFloat(n[2]);return{min:Math.min(i,a),max:Math.max(i,a)}}const o=e.match(/(\d+(?:\.\d+)?)\s*%/),r=o?parseFloat(o[1]):100;return{min:r,max:r}}function Me(t,e){if(!t)return!1;try{const n=new URL(t,location.href);if(n.origin===location.origin)return!0;const r=n.host.toLowerCase();if(["fonts.googleapis.com","fonts.gstatic.com","use.typekit.net","p.typekit.net","kit.fontawesome.com","use.fontawesome.com"].some(s=>r.endsWith(s)))return!0;const a=(n.pathname+n.search).toLowerCase();if(/\bfont(s)?\b/.test(a)||/\.woff2?(\b|$)/.test(a))return!0;for(const s of e){const u=s.toLowerCase().replace(/\s+/g,"+"),c=s.toLowerCase().replace(/\s+/g,"-");if(a.includes(u)||a.includes(c))return!0}return!1}catch{return!1}}function Le(t){const e=new Set;for(const n of t||[]){const o=String(n).split("__")[0]?.trim();o&&e.add(o)}return e}async function Re({required:t,usedCodepoints:e,exclude:n=void 0,localFonts:o=[],useProxy:r=""}={}){t instanceof Set||(t=new Set),e instanceof Set||(e=new Set);const i=new Map;for(const f of t){const[p,g,b,h]=String(f).split("__");if(!p)continue;const y=i.get(p)||[];y.push({w:parseInt(g,10),s:b,st:parseInt(h,10)}),i.set(p,y)}const a=/@import\s+url\(["']?([^"')]+)["']?\)/g,s=/url\((["']?)([^"')]+)\1\)/g,u=/@font-face[^{}]*\{[^}]*\}/g;function c(f,p,g,b){if(!i.has(f))return!1;const h=i.get(f),y=ve(g),k=Ae(p),S=Ee(b),A=y.min!==y.max,M=y.min,F=v=>k.kind==="normal"&&v==="normal"||k.kind!=="normal"&&(v==="italic"||v==="oblique");let O=!1;for(const v of h){const I=A?v.w>=y.min&&v.w<=y.max:v.w===M,U=F(dt(v.s)),R=v.st>=S.min&&v.st<=S.max;if(I&&U&&R){O=!0;break}}if(O)return!0;if(!A)for(const v of h){const I=F(dt(v.s)),U=v.st>=S.min&&v.st<=S.max;if(Math.abs(M-v.w)<=300&&I&&U)return!0}return!1}function l(f){if(!f)return[];const p=[],g=f.split(",").map(b=>b.trim()).filter(Boolean);for(const b of g){const h=b.match(/^U\+([0-9A-Fa-f?]+)(?:-([0-9A-Fa-f?]+))?$/);if(!h)continue;const y=h[1],k=h[2],S=A=>{if(!A.includes("?"))return parseInt(A,16);const M=parseInt(A.replace(/\?/g,"0"),16),F=parseInt(A.replace(/\?/g,"F"),16);return[M,F]};if(k){const A=S(y),M=S(k),F=Array.isArray(A)?A[0]:A,O=Array.isArray(M)?M[1]:M;p.push([Math.min(F,O),Math.max(F,O)])}else{const A=S(y);Array.isArray(A)?p.push([A[0],A[1]]):p.push([A,A])}}return p}function d(f,p){if(!p.length||!f||f.size===0)return!0;for(const g of f)for(const[b,h]of p)if(g>=b&&g<=h)return!0;return!1}function x(f,p){const g=[];if(!f)return g;for(const b of f.matchAll(s)){let h=(b[2]||"").trim();if(!(!h||h.startsWith("data:"))){if(!/^https?:/i.test(h))try{h=new URL(h,p||location.href).href}catch{}g.push(h)}}return g}async function N(f,p){let g=f;for(const b of f.matchAll(s)){const h=ht(b[0]);if(!h)continue;let y=h;if(!y.startsWith("http")&&!y.startsWith("data:"))try{y=new URL(y,p||location.href).href}catch{}if(!H(y)){if(m.resource?.has(y)){m.font?.add(y),g=g.replace(b[0],`url(${m.resource.get(y)})`);continue}if(!m.font?.has(y))try{const k=await z(y,{as:"dataURL",useProxy:r,silent:!0});if(k.ok&&typeof k.data=="string"){const S=k.data;m.resource?.set(y,S),m.font?.add(y),g=g.replace(b[0],`url(${S})`)}}catch{console.warn("[snapDOM] Failed to fetch font resource:",y)}}}return g}function C(f){if(!f.length)return null;const p=(S,A)=>f.some(([M,F])=>!(F<S||M>A)),g=p(0,255)||p(305,305),b=p(256,591)||p(7680,7935),h=p(880,1023),y=p(1024,1279);return p(7840,7929)||p(258,259)||p(416,417)||p(431,432)?"vietnamese":y?"cyrillic":h?"greek":b?"latin-ext":g?"latin":null}function $(f={}){const p=new Set((f.families||[]).map(h=>String(h).toLowerCase())),g=new Set((f.domains||[]).map(h=>String(h).toLowerCase())),b=new Set((f.subsets||[]).map(h=>String(h).toLowerCase()));return(h,y)=>{if(p.size&&p.has(h.family.toLowerCase()))return!0;if(g.size)for(const k of h.srcUrls)try{if(g.has(new URL(k).host.toLowerCase()))return!0}catch{}if(b.size){const k=C(y);if(k&&b.has(k))return!0}return!1}}const w=$(n);function L(f){if(!f)return f;const p=/@font-face[^{}]*\{[^}]*\}/gi,g=new Set,b=[];for(const y of f.match(p)||[]){const k=y.match(/font-family:\s*([^;]+);/i)?.[1]||"",S=et(k),A=(y.match(/font-weight:\s*([^;]+);/i)?.[1]||"400").trim(),M=(y.match(/font-style:\s*([^;]+);/i)?.[1]||"normal").trim(),F=(y.match(/font-stretch:\s*([^;]+);/i)?.[1]||"100%").trim(),O=(y.match(/unicode-range:\s*([^;]+);/i)?.[1]||"").trim(),v=(y.match(/src\s*:\s*([^;]+);/i)?.[1]||"").trim(),I=x(v,location.href),U=I.length?I.map(q=>String(q).toLowerCase()).sort().join("|"):v.toLowerCase(),R=[String(S||"").toLowerCase(),A,M,F,O.toLowerCase(),U].join("|");g.has(R)||(g.add(R),b.push(y))}if(b.length===0)return f;let h=0;return f.replace(p,()=>b[h++]||"")}function E(){const f=Array.from(t||[]).sort().join("|"),p=n?JSON.stringify({families:(n.families||[]).map(h=>String(h).toLowerCase()).sort(),domains:(n.domains||[]).map(h=>String(h).toLowerCase()).sort(),subsets:(n.subsets||[]).map(h=>String(h).toLowerCase()).sort()}):"",g=(o||[]).map(h=>`${(h.family||"").toLowerCase()}::${h.weight||"normal"}::${h.style||"normal"}::${h.src||""}`).sort().join("|");return`fonts-embed-css::req=${f}::ex=${p}::lf=${g}::px=${r||""}`}const T=E();if(m.resource?.has(T))return m.resource.get(T);const _=Le(t),D=[];for(const f of document.querySelectorAll("style")){const p=f.textContent||"";for(const g of p.matchAll(a)){const b=g[1];if(!b||H(b))continue;!!document.querySelector(`link[rel="stylesheet"][href="${b}"]`)||D.push(b)}}D.length&&await Promise.all(D.map(f=>new Promise(p=>{if(document.querySelector(`link[rel="stylesheet"][href="${f}"]`))return p(null);const g=document.createElement("link");g.rel="stylesheet",g.href=f,g.setAttribute("data-snapdom","injected-import"),g.onload=()=>p(g),g.onerror=()=>p(null),document.head.appendChild(g)})));let W="";const B=Array.from(document.querySelectorAll('link[rel="stylesheet"]')).filter(f=>!!f.href);for(const f of B)try{if(H(f.href))continue;let p="",g=!1;try{g=new URL(f.href,location.href).origin===location.origin}catch{}if(!g&&!Me(f.href,_))continue;if(g){const h=Array.from(document.styleSheets).find(y=>y.href===f.href);if(h)try{const y=h.cssRules||[];p=Array.from(y).map(k=>k.cssText).join("")}catch{}}if(!p&&(p=(await z(f.href,{as:"text",useProxy:r})).data,H(f.href)))continue;let b="";for(const h of p.match(u)||[]){const y=(h.match(/font-family:\s*([^;]+);/i)?.[1]||"").trim(),k=et(y);if(!k||H(k))continue;const S=(h.match(/font-weight:\s*([^;]+);/i)?.[1]||"400").trim(),A=(h.match(/font-style:\s*([^;]+);/i)?.[1]||"normal").trim(),M=(h.match(/font-stretch:\s*([^;]+);/i)?.[1]||"100%").trim(),F=(h.match(/unicode-range:\s*([^;]+);/i)?.[1]||"").trim(),O=(h.match(/src\s*:\s*([^;]+);/i)?.[1]||"").trim(),v=x(O,f.href);if(!c(k,A,S,M))continue;const I=l(F);if(!d(e,I))continue;const U={family:k,weightSpec:S,styleSpec:A,stretchSpec:M,unicodeRange:F,srcRaw:O,srcUrls:v,href:f.href};if(n&&w(U,I))continue;const R=/url\(/i.test(O)?await N(h,f.href):h;b+=R+""}b.trim()&&(W+=b+"")}catch{console.warn("[snapdom] Failed to process stylesheet:",f.href)}for(const f of document.styleSheets)try{if(f.href&&B.some(g=>g.href===f.href))continue;const p=f.cssRules||[];for(const g of p){if(g.type!==CSSRule.FONT_FACE_RULE)continue;const b=(g.style.getPropertyValue("font-family")||"").trim(),h=et(b);if(!h||H(h))continue;const y=(g.style.getPropertyValue("font-weight")||"400").trim(),k=(g.style.getPropertyValue("font-style")||"normal").trim(),S=(g.style.getPropertyValue("font-stretch")||"100%").trim(),A=(g.style.getPropertyValue("src")||"").trim(),M=(g.style.getPropertyValue("unicode-range")||"").trim(),F=x(A,f.href||location.href);if(!c(h,k,y,S))continue;const O=l(M);if(!d(e,O))continue;const v={family:h,weightSpec:y,styleSpec:k,stretchSpec:S,unicodeRange:M,srcRaw:A,srcUrls:F,href:f.href||location.href};if(!(n&&w(v,O)))if(/url\(/i.test(A)){const I=await N(A,f.href||location.href);W+=`@font-face{font-family:${h};src:${I};font-style:${k};font-weight:${y};font-stretch:${S};${M?`unicode-range:${M};`:""}}`}else W+=`@font-face{font-family:${h};src:${A};font-style:${k};font-weight:${y};font-stretch:${S};${M?`unicode-range:${M};`:""}}`}}catch{}try{for(const f of document.fonts||[]){if(!f||!f.family||f.status!=="loaded"||!f._snapdomSrc)continue;const p=String(f.family).replace(/^['"]+|['"]+$/g,"");if(H(p)||!i.has(p)||n?.families&&n.families.some(b=>String(b).toLowerCase()===p.toLowerCase()))continue;let g=f._snapdomSrc;if(!String(g).startsWith("data:")){if(m.resource?.has(f._snapdomSrc))g=m.resource.get(f._snapdomSrc),m.font?.add(f._snapdomSrc);else if(!m.font?.has(f._snapdomSrc))try{const b=await z(f._snapdomSrc,{as:"dataURL",useProxy:r,silent:!0});if(b.ok&&typeof b.data=="string")g=b.data,m.resource?.set(f._snapdomSrc,g),m.font?.add(f._snapdomSrc);else continue}catch{console.warn("[snapdom] Failed to fetch dynamic font src:",f._snapdomSrc);continue}}W+=`@font-face{font-family:'${p}';src:url(${g});font-style:${f.style||"normal"};font-weight:${f.weight||"normal"};}`}}catch{}for(const f of o){if(!f||typeof f!="object")continue;const p=String(f.family||"").replace(/^['"]+|['"]+$/g,"");if(!p||H(p)||!i.has(p)||n?.families&&n.families.some(S=>String(S).toLowerCase()===p.toLowerCase()))continue;const g=f.weight!=null?String(f.weight):"normal",b=f.style!=null?String(f.style):"normal",h=f.stretchPct!=null?`${f.stretchPct}%`:"100%",y=String(f.src||"");let k=y;if(!k.startsWith("data:")){if(m.resource?.has(y))k=m.resource.get(y),m.font?.add(y);else if(!m.font?.has(y))try{const S=await z(y,{as:"dataURL",useProxy:r,silent:!0});if(S.ok&&typeof S.data=="string")k=S.data,m.resource?.set(y,k),m.font?.add(y);else continue}catch{console.warn("[snapdom] Failed to fetch localFonts src:",y);continue}}W+=`@font-face{font-family:'${p}';src:url(${k});font-style:${b};font-weight:${g};font-stretch:${h};}`}return W&&(W=L(W),m.resource?.set(T,W)),W}function Ne(t){const e=new Set;if(!t)return e;const n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,null),o=a=>{const s=et(a.fontFamily);if(!s)return;const u=(c,l,d)=>`${s}__${nt(c)}__${dt(l)}__${ke(d)}`;e.add(u(a.fontWeight,a.fontStyle,a.fontStretch))};o(getComputedStyle(t));const r=getComputedStyle(t,"::before");r&&r.content&&r.content!=="none"&&o(r);const i=getComputedStyle(t,"::after");for(i&&i.content&&i.content!=="none"&&o(i);n.nextNode();){const a=n.currentNode,s=getComputedStyle(a);o(s);const u=getComputedStyle(a,"::before");u&&u.content&&u.content!=="none"&&o(u);const c=getComputedStyle(a,"::after");c&&c.content&&c.content!=="none"&&o(c)}return e}function Te(t){const e=new Set,n=r=>{if(r)for(const i of r)e.add(i.codePointAt(0))},o=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,null);for(;o.nextNode();){const r=o.currentNode;if(r.nodeType===Node.TEXT_NODE)n(r.nodeValue||"");else if(r.nodeType===Node.ELEMENT_NODE){const i=r;for(const a of["::before","::after"]){const u=getComputedStyle(i,a)?.getPropertyValue("content");if(!(!u||u==="none"))if(/^"/.test(u)||/^'/.test(u))n(u.slice(1,-1));else{const c=u.match(/\\[0-9A-Fa-f]{1,6}/g);if(c)for(const l of c)try{e.add(parseInt(l.slice(1),16))}catch{}}}}}return e}async function Fe(t,e=2){try{await document.fonts.ready}catch{}const n=Array.from(t||[]).filter(Boolean);if(n.length===0)return;const o=()=>{const r=document.createElement("div");r.style.cssText="position: absolute !important;left: -9999px !important;top: 0 !important;opacity: 0 !important;pointer-events: none !important;contain: layout size style;";for(const i of n){const a=document.createElement("span");a.textContent="AaBbGg1234ÁÉÍÓÚçñ—∞",a.style.fontFamily=`"${i}"`,a.style.fontWeight="700",a.style.fontStyle="italic",a.style.fontSize="32px",a.style.lineHeight="1",a.style.whiteSpace="nowrap",a.style.margin="0",a.style.padding="0",r.appendChild(a)}document.body.appendChild(r),r.offsetWidth,document.body.removeChild(r)};for(let r=0;r<Math.max(1,e);r++)o(),await new Promise(i=>requestAnimationFrame(()=>requestAnimationFrame(i)))}async function Nt(t,e,n,o){if(!(t instanceof Element)||!(e instanceof Element))return;for(const a of["::before","::after","::first-letter"])try{const s=Mt(t,a);if(!s||typeof s[Symbol.iterator]!="function"||s.content==="none"&&s.backgroundImage==="none"&&s.backgroundColor==="transparent"&&(s.borderStyle==="none"||parseFloat(s.borderWidth)===0)&&(!s.transform||s.transform==="none")&&s.display==="inline")continue;if(a==="::first-letter"){const v=getComputedStyle(t);if(!(s.color!==v.color||s.fontSize!==v.fontSize||s.fontWeight!==v.fontWeight))continue;const U=Array.from(e.childNodes).find(yt=>yt.nodeType===Node.TEXT_NODE&&yt.textContent?.trim().length>0);if(!U)continue;const R=U.textContent,V=R.match(/^([^\p{L}\p{N}\s]*[\p{L}\p{N}](?:['’])?)/u)?.[0],rt=R.slice(V?.length||0);if(!V||/[\uD800-\uDFFF]/.test(V))continue;const j=document.createElement("span");j.textContent=V,j.dataset.snapdomPseudo="::first-letter";const It=bt(s),Pt=ct(It,"span");n.styleMap.set(j,Pt);const gt=document.createTextNode(rt);e.replaceChild(gt,U),e.insertBefore(j,gt);continue}const c=s.content,l=/counter\s*\(|counters\s*\(/.test(c)?"- ":Qt(c),d=s.backgroundImage,x=s.backgroundColor,N=s.fontFamily,C=parseInt(s.fontSize)||32,$=parseInt(s.fontWeight)||!1,w=s.color||"#000",L=s.display,E=parseFloat(s.width),T=parseFloat(s.height),_=s.borderStyle,D=parseFloat(s.borderWidth),W=s.transform,B=H(N),f=c!=="none"&&l!=="",p=d&&d!=="none",g=x&&x!=="transparent"&&x!=="rgba(0, 0, 0, 0)",b=L!=="inline"&&(E>0||T>0),h=_&&_!=="none"&&D>0,y=W&&W!=="none";if(!(f||p||g||b||h||y))continue;const S=document.createElement("span");S.dataset.snapdomPseudo=a,S.style.verticalAlign="middle";const A=bt(s),M=ct(A,"span");if(n.styleMap.set(S,M),B&&l.length===1){const{dataUrl:v,width:I,height:U}=await Ce(l,N,$,C,w),R=document.createElement("img");R.src=v,R.style=`height:${C}px;width:${I/U*C}px;object-fit:contain;`,S.appendChild(R),e.dataset.snapdomHasIcon="true"}else if(l.startsWith("url(")){const v=ht(l);if(v?.trim())try{const I=document.createElement("img"),U=await z(vt(v),{as:"dataURL",useProxy:o.useProxy});I.src=U.data,I.style=`width:${C}px;height:auto;object-fit:contain;`,S.appendChild(I)}catch(I){console.error(`[snapdom] Error in pseudo ${a} for`,t,I)}}else!B&&f&&(S.textContent=l);if(p)try{const v=Lt(d),I=await Promise.all(v.map(At));S.style.backgroundImage=I.join(", ")}catch(v){console.warn(`[snapdom] Failed to inline background-image for ${a}`,v)}if(g&&(S.style.backgroundColor=x),!(S.childNodes.length>0||S.textContent?.trim()!==""||p||g||b||h||y))continue;a==="::before"?e.insertBefore(S,e.firstChild):e.appendChild(S)}catch(s){console.warn(`[snapdom] Failed to capture ${a} for`,t,s)}const r=Array.from(t.children),i=Array.from(e.children).filter(a=>!a.dataset.snapdomPseudo);for(let a=0;a<Math.min(r.length,i.length);a++)await Nt(r[a],i[a],n,o)}function Ie(t){if(!t)return;const e=new Set;if(t.querySelectorAll("use").forEach(s=>{const u=s.getAttribute("xlink:href")||s.getAttribute("href");u&&u.startsWith("#")&&e.add(u.slice(1))}),!e.size)return;const n=Array.from(document.querySelectorAll("svg > symbol, svg > defs")),o=n.filter(s=>s.tagName.toLowerCase()==="symbol"),r=n.filter(s=>s.tagName.toLowerCase()==="defs");let i=t.querySelector("svg.inline-defs-container");i||(i=document.createElementNS("http://www.w3.org/2000/svg","svg"),i.setAttribute("aria-hidden","true"),i.setAttribute("style","position: absolute; width: 0; height: 0; overflow: hidden;"),i.classList.add("inline-defs-container"),t.insertBefore(i,t.firstChild));const a=new Set;t.querySelectorAll("symbol[id], defs > *[id]").forEach(s=>{a.add(s.id)}),e.forEach(s=>{if(a.has(s))return;const u=o.find(c=>c.id===s);if(u){i.appendChild(u.cloneNode(!0)),a.add(s);return}for(const c of r){const l=c.querySelector(`#${CSS.escape(s)}`);if(l){let d=i.querySelector("defs");d||(d=document.createElementNS("http://www.w3.org/2000/svg","defs"),i.appendChild(d)),d.appendChild(l.cloneNode(!0)),a.add(s);break}}})}async function Pe(t,e={}){const n={styleMap:m.session.styleMap,styleCache:m.session.styleCache,nodeMap:m.session.nodeMap};let o,r="",i="";_e(t);try{Ie(t)}catch(s){console.warn("inlineExternal defs or symbol failed:",s)}try{o=await tt(t,n,e,t)}catch(s){throw console.warn("deepClone failed:",s),s}try{await Nt(t,o,n,e)}catch(s){console.warn("inlinePseudoElements failed:",s)}await Be(o);try{const s=o.querySelectorAll("style[data-sd]");for(const u of s)i+=u.textContent||"",u.remove()}catch{}const a=Zt(n.styleMap);r=Array.from(a.entries()).map(([s,u])=>`.${u}{${s}}`).join(""),r=i+r;for(const[s,u]of n.styleMap.entries()){if(s.tagName==="STYLE")continue;if(s.getRootNode&&s.getRootNode()instanceof ShadowRoot){s.setAttribute("style",u.replace(/;/g,"; "));continue}const c=a.get(u);c&&s.classList.add(c);const l=s.style?.backgroundImage,d=s.dataset?.snapdomHasIcon;l&&l!=="none"&&(s.style.backgroundImage=l),d&&(s.style.verticalAlign="middle",s.style.display="inline")}for(const[s,u]of n.nodeMap.entries()){const c=u.scrollLeft,l=u.scrollTop;if((c||l)&&s instanceof HTMLElement){s.style.overflow="hidden",s.style.scrollbarWidth="none",s.style.msOverflowStyle="none";const x=document.createElement("div");for(x.style.transform=`translate(${-c}px, ${-l}px)`,x.style.willChange="transform",x.style.display="inline-block",x.style.width="100%";s.firstChild;)x.appendChild(s.firstChild);s.appendChild(x)}}if(t===n.nodeMap.get(o)){const s=n.styleCache.get(t)||window.getComputedStyle(t);n.styleCache.set(t,s);const u=Ot(s.transform);o.style.margin="0",o.style.position="static",o.style.top="auto",o.style.left="auto",o.style.right="auto",o.style.bottom="auto",o.style.zIndex="auto",o.style.float="none",o.style.clear="none",o.style.transform=u||""}for(const[s,u]of n.nodeMap.entries())u.tagName==="PRE"&&(s.style.marginTop="0",s.style.marginBlockStart="0");return{clone:o,classCSS:r,styleCache:n.styleCache}}function _e(t){const e=getComputedStyle(t),n=e.outlineStyle,o=e.outlineWidth,r=e.borderStyle,i=e.borderWidth,a=n!=="none"&&parseFloat(o)>0,s=r==="none"||parseFloat(i)===0;a&&s&&(t.style.border=`${o} solid transparent`)}var Y=new Map;async function J(t){if(m.resource?.has(t))return m.resource.get(t);if(Y.has(t))return Y.get(t);const e=(async()=>{const n=await z(t,{as:"dataURL",silent:!0});if(!n.ok||typeof n.data!="string")throw new Error(`[snapDOM] Failed to read blob URL: ${t}`);return m.resource?.set(t,n.data),n.data})();Y.set(t,e);try{const n=await e;return Y.set(t,n),n}catch(n){throw Y.delete(t),n}}var We=/\bblob:[^)"'\s]+/g;async function $t(t){if(!t||t.indexOf("blob:")===-1)return t;const e=Array.from(new Set(t.match(We)||[]));if(e.length===0)return t;let n=t;for(const o of e)try{const r=await J(o);n=n.split(o).join(r)}catch{}return n}function Q(t){return typeof t=="string"&&t.startsWith("blob:")}function Oe(t){return(t||"").split(",").map(e=>e.trim()).filter(Boolean).map(e=>{const n=e.match(/^(\S+)(\s+.+)?$/);return n?{url:n[1],desc:n[2]||""}:null}).filter(Boolean)}function Ue(t){return t.map(e=>e.desc?`${e.url} ${e.desc.trim()}`:e.url).join(", ")}async function Be(t){if(!t)return;const e=t.querySelectorAll?t.querySelectorAll("img"):[];for(const a of e)try{const u=a.getAttribute("src")||a.currentSrc||"";if(Q(u)){const l=await J(u);a.setAttribute("src",l)}const c=a.getAttribute("srcset");if(c&&c.includes("blob:")){const l=Oe(c);let d=!1;for(const x of l)if(Q(x.url))try{x.url=await J(x.url),d=!0}catch{}d&&a.setAttribute("srcset",Ue(l))}}catch{}const n=t.querySelectorAll?t.querySelectorAll("image"):[];for(const a of n)try{const s="http://www.w3.org/1999/xlink",u=a.getAttribute("href")||a.getAttributeNS?.(s,"href");if(Q(u)){const c=await J(u);a.setAttribute("href",c),a.removeAttributeNS?.(s,"href")}}catch{}const o=t.querySelectorAll?t.querySelectorAll("[style*='blob:']"):[];for(const a of o)try{const s=a.getAttribute("style");if(s&&s.includes("blob:")){const u=await $t(s);a.setAttribute("style",u)}}catch{}const r=t.querySelectorAll?t.querySelectorAll("style"):[];for(const a of r)try{const s=a.textContent||"";s.includes("blob:")&&(a.textContent=await $t(s))}catch{}const i=["poster"];for(const a of i){const s=t.querySelectorAll?t.querySelectorAll(`[${a}^='blob:']`):[];for(const u of s)try{const c=u.getAttribute(a);Q(c)&&u.setAttribute(a,await J(c))}catch{}}}async function De(t,e={}){const n=Array.from(t.querySelectorAll("img")),o=async r=>{if(!r.getAttribute("src")){const l=r.currentSrc||r.src||"";l&&r.setAttribute("src",l)}r.removeAttribute("srcset"),r.removeAttribute("sizes");const i=r.src||"";if(!i)return;const a=await z(i,{as:"dataURL",useProxy:e.useProxy});if(a.ok&&typeof a.data=="string"&&a.data.startsWith("data:")){r.src=a.data,r.width||(r.width=r.naturalWidth||100),r.height||(r.height=r.naturalHeight||100);return}const{defaultImageUrl:s}=e||{};if(s)try{const l=parseInt(r.dataset?.snapdomWidth||"",10)||0,d=parseInt(r.dataset?.snapdomHeight||"",10)||0,x=parseInt(r.getAttribute("width")||"",10)||0,N=parseInt(r.getAttribute("height")||"",10)||0,C=parseFloat(r.style?.width||"")||0,$=parseFloat(r.style?.height||"")||0,w=l||C||x||r.width||void 0,L=d||$||N||r.height||void 0,E=typeof s=="function"?await s({width:w,height:L,src:i,element:r}):s;if(E){const T=await z(E,{as:"dataURL",useProxy:e.useProxy});r.src=T.data,!r.width&&w&&(r.width=w),!r.height&&L&&(r.height=L),r.width||(r.width=r.naturalWidth||100),r.height||(r.height=r.naturalHeight||100);return}}catch{}const u=r.width||r.naturalWidth||100,c=r.height||r.naturalHeight||100;if(e.placeholders!==!1){const l=document.createElement("div");l.style.cssText=[`width:${u}px`,`height:${c}px`,"background:#ccc","display:inline-block","text-align:center",`line-height:${c}px`,"color:#666","font-size:12px","overflow:hidden"].join(";"),l.textContent="img",r.replaceWith(l)}else{const l=document.createElement("div");l.style.cssText=`display:inline-block;width:${u}px;height:${c}px;visibility:hidden;`,r.replaceWith(l)}};for(let r=0;r<n.length;r+=4){const i=n.slice(r,r+4).map(o);await Promise.allSettled(i)}}async function qe(t,e,n,o={}){const r=[[t,e]],i=["background-image","mask","mask-image","-webkit-mask","-webkit-mask-image","mask-source","mask-box-image-source","mask-border-source","-webkit-mask-box-image-source","border-image","border-image-source"],a=["mask-position","mask-size","mask-repeat","-webkit-mask-position","-webkit-mask-size","-webkit-mask-repeat","mask-origin","mask-clip","-webkit-mask-origin","-webkit-mask-clip","-webkit-mask-position-x","-webkit-mask-position-y"],s=["border-image-slice","border-image-width","border-image-outset","border-image-repeat"];for(;r.length;){const[u,c]=r.shift(),l=n.get(u)||Mt(u);n.has(u)||n.set(u,l);const d=(()=>{const C=l.getPropertyValue("border-image"),$=l.getPropertyValue("border-image-source");return C&&C!=="none"||$&&$!=="none"})();for(const C of i){const $=l.getPropertyValue(C);if(!$||$==="none")continue;const w=Lt($),L=await Promise.all(w.map(E=>At(E,o)));L.some(E=>E&&E!=="none"&&!/^url\(undefined/.test(E))&&c.style.setProperty(C,L.join(", "))}for(const C of a){const $=l.getPropertyValue(C);!$||$==="initial"||c.style.setProperty(C,$)}if(d)for(const C of s){const $=l.getPropertyValue(C);!$||$==="initial"||c.style.setProperty(C,$)}const x=Array.from(u.children),N=Array.from(c.children);for(let C=0;C<Math.min(x.length,N.length);C++)r.push([x[C],N[C]])}}async function je(t,e){if(!t)throw new Error("Element cannot be null or undefined");Wt(e.cache);const n=e.fast;let o,r,i,a="",s="",u,c;({clone:o,classCSS:r,styleCache:i}=await Pe(t,e)),await new Promise(N=>{X(async()=>{await De(o,e),N()},{fast:n})}),await new Promise(N=>{X(async()=>{await qe(t,o,i,e),N()},{fast:n})}),e.embedFonts&&await new Promise(N=>{X(async()=>{const C=Ne(t),$=Te(t);if(Rt){const w=new Set(Array.from(C).map(L=>String(L).split("__")[0]).filter(Boolean));await Fe(w,5)}a=await Re({required:C,usedCodepoints:$,exclude:e.excludeFonts,useProxy:e.useProxy}),N()},{fast:n})});const l=Gt(o).sort(),d=l.join(",");m.baseStyle.has(d)?s=m.baseStyle.get(d):await new Promise(N=>{X(()=>{s=Jt(l),m.baseStyle.set(d,s),N()},{fast:n})}),await new Promise(N=>{X(()=>{const C=He(t);let $=C.width,w=C.height;const L=Number.isFinite(e.width),E=Number.isFinite(e.height),T=e.scale??1,_=typeof T=="number"&&T!==1;if(!_){const R=C.width/C.height;L&&E?($=e.width,w=e.height):L?($=e.width,w=$/R):E&&(w=e.height,$=w*R)}$=Math.max(1,Math.ceil($)),w=Math.max(1,Math.ceil(w));const D=getComputedStyle(t),W=D.transform&&D.transform!=="none"?D.transform:"",B=Xe(t);let f,p,g,b,h=0,y=0;if(Ke(t)){const R=Je({baseTransform:W,rotate:B.rotate||"0deg",scale:B.scale,translate:B.translate}),q=R.e??R.m41??0,V=R.f??R.m42??0;h=-q,y=-V;const rt=R.is2D?kt(R):kt(new DOMMatrix(R.toString())),j=Ve($,w,rt);f=Math.max(1,Math.ceil(j.width)),p=Math.max(1,Math.ceil(j.height)),g=-j.minX,b=-j.minY}else{const R=t.getBoundingClientRect(),q=Ye(R,{top:0,right:0,bottom:0,left:0});f=Math.max(1,q.width),p=Math.max(1,q.height),g=-(q.x-Math.floor(R.left)),b=-(q.y-Math.floor(R.top))}const k="http://www.w3.org/2000/svg",S=document.createElementNS(k,"foreignObject");S.setAttribute("width","100%"),S.setAttribute("height","100%"),S.setAttribute("x",String(g)),S.setAttribute("y",String(b)),S.style.overflow="visible";const A=document.createElement("style");A.textContent=s+a+"svg{overflow:visible;} foreignObject{overflow:visible;}"+r,S.appendChild(A);const M=document.createElement("div");M.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),M.style.width=`${$}px`,M.style.height=`${w}px`,M.style.overflow="visible",M.style.transformOrigin="0 0";const F=[];if((h||y)&&F.push(`translate(${h}px, ${y}px)`),!_&&(L||E)){const R=C.width?$/C.width:1,q=C.height?w/C.height:1;F.push(`scale(${R}, ${q})`)}else _&&F.push(`scale(${T})`);F.length&&(M.style.transform=F.join(" ")),o.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),o.style.transformOrigin="0 0",o.style.position="static",o.style.left="0",o.style.top="0",W&&(o.style.transform=W),o.style.rotate=B.rotate||"0deg",o.style.scale=B.scale||"1",o.style.translate=B.translate||"0 0",M.appendChild(o),S.appendChild(M);const v=new XMLSerializer().serializeToString(S);c=`<svg xmlns="${k}" width="${f}" height="${p}" viewBox="0 0 ${f} ${p}">`+v+"</svg>",u=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(c)}`,N()},{fast:n})});const x=document.getElementById("snapdom-sandbox");return x&&x.style.position==="absolute"&&x.remove(),u}function He(t){const e=getComputedStyle(t),n=i=>parseFloat(i)||0;let o=n(e.width),r=n(e.height);return e.boxSizing==="content-box"&&(o+=n(e.paddingLeft)+n(e.paddingRight)+n(e.borderLeftWidth)+n(e.borderRightWidth),r+=n(e.paddingTop)+n(e.paddingBottom)+n(e.borderTopWidth)+n(e.borderBottomWidth)),{width:o,height:r}}function ze(t){const e=getComputedStyle(t).transform;if(!e||e==="none")return new DOMMatrix;try{return new DOMMatrix(e)}catch{return new WebKitCSSMatrix(e)}}function kt(t){return new DOMMatrix([t.a,t.b,t.c,t.d,0,0])}function Ve(t,e,n){const r=[{x:0,y:0},{x:t,y:0},{x:0,y:e},{x:t,y:e}].map(c=>({x:n.a*c.x+n.c*c.y,y:n.b*c.x+n.d*c.y})),i=Math.min(...r.map(c=>c.x)),a=Math.max(...r.map(c=>c.x)),s=Math.min(...r.map(c=>c.y)),u=Math.max(...r.map(c=>c.y));return{minX:i,minY:s,width:a-i,height:u-s}}function Xe(t){const e={rotate:"0deg",scale:null,translate:null},n=t.computedStyleMap?.();if(n){const r=n.get("rotate");if(r){const s=r.angle??r;s&&"unit"in s?e.rotate=s.unit==="rad"?s.value*180/Math.PI+"deg":s.value+s.unit:e.rotate=String(r)}const i=n.get("scale");if(i&&i.length){const s=i[0]?.value??1,u=i[1]?.value??s;e.scale=`${s} ${u}`}const a=n.get("translate");if(a&&a.length){const s=a[0]?.value??0,u=a[1]?.value??0,c=a[0]?.unit??"px",l=a[1]?.unit??"px";e.translate=`${s}${c} ${u}${l}`}return e}const o=getComputedStyle(t);return e.rotate=o.rotate&&o.rotate!=="none"?o.rotate:"0deg",e.scale=o.scale&&o.scale!=="none"?o.scale:null,e.translate=o.translate&&o.translate!=="none"?o.translate:null,e}function Ke(t){const e=getComputedStyle(t).transform||"none";return!(e==="none"||e==="matrix(1, 0, 0, 1, 0, 0)"||/^matrix\(\s*1\s*,\s*0\s*,\s*0\s*,\s*1\s*,/i.test(e))}function Ye(t,e){const n=Math.floor(t.left-e.left),o=Math.floor(t.top-e.top),r=Math.ceil(t.width+e.left+e.right),i=Math.ceil(t.height+e.top+e.bottom);return{x:n,y:o,width:r,height:i}}var it=null;function Ge(){if(it)return it;const t=document.createElement("div");return t.id="snapdom-measure-slot",t.setAttribute("aria-hidden","true"),Object.assign(t.style,{position:"absolute",left:"-99999px",top:"0px",width:"0px",height:"0px",overflow:"hidden",opacity:"0",pointerEvents:"none",contain:"size layout style"}),document.documentElement.appendChild(t),it=t,t}function Je(t){const e=Ge(),n=document.createElement("div");n.style.transformOrigin="0 0",t.baseTransform&&(n.style.transform=t.baseTransform),t.rotate&&(n.style.rotate=t.rotate),t.scale&&(n.style.scale=t.scale),t.translate&&(n.style.translate=t.translate),e.appendChild(n);const o=ze(n);return e.removeChild(n),o}function Ze(t){if(typeof t=="string"){const e=t.toLowerCase().trim();if(e==="disabled"||e==="full"||e==="auto"||e==="soft")return e}return"soft"}function Qe(t={}){const e=t.format??"png",n=Ze(t.cache);return{debug:t.debug??!1,fast:t.fast??!0,scale:t.scale??1,exclude:t.exclude??[],filter:t.filter??null,placeholders:t.placeholders!==!1,embedFonts:t.embedFonts??!1,iconFonts:Array.isArray(t.iconFonts)?t.iconFonts:t.iconFonts?[t.iconFonts]:[],localFonts:Array.isArray(t.localFonts)?t.localFonts:[],excludeFonts:t.excludeFonts??void 0,defaultImageUrl:t.defaultImageUrl??void 0,cache:n,useProxy:typeof t.useProxy=="string"?t.useProxy:"",width:t.width??null,height:t.height??null,format:e,type:t.type??"svg",quality:t.quality??.92,dpr:t.dpr??(window.devicePixelRatio||1),backgroundColor:t.backgroundColor??(["jpg","jpeg","webp"].includes(e)?"#ffffff":null),filename:t.filename??"snapDOM"}}async function tn(t,e){const n=new Image;return n.src=t,await n.decode(),e.scale!==1&&(n.style.width=`${n.naturalWidth*e.scale}px`,n.style.height=`${n.naturalHeight*e.scale}px`),n}async function ot(t,e){const{scale:n,dpr:o}=e,r=Rt(),i=new Image;i.crossOrigin="anonymous",i.loading="eager",i.decoding="sync",i.src=t;let a=null;r&&(a=document.createElement("div"),a.setAttribute("aria-hidden","true"),a.style.cssText="position:absolute;left:-99999px;top:0;width:0;height:0;overflow:hidden;opacity:0;pointer-events:none;contain:size layout style;",document.body.appendChild(a),a.appendChild(i)),await i.decode(),r&&await new Promise(d=>setTimeout(d,100));const s=i.naturalWidth*n,u=i.naturalHeight*n,c=document.createElement("canvas");c.width=Math.ceil(s*o),c.height=Math.ceil(u*o),c.style.width=`${s}px`,c.style.height=`${u}px`;const l=c.getContext("2d");if(o!==1&&l.scale(o,o),l.drawImage(i,0,0,s,u),a&&a.parentNode)try{a.parentNode.removeChild(a)}catch{}return c}async function Tt(t,e){const n=e.type;if(n==="svg"){const i=decodeURIComponent(t.split(",")[1]);return new Blob([i],{type:"image/svg+xml"})}const o=await ot(t,e),r=e.backgroundColor?mt(o,e.backgroundColor):o;return new Promise(i=>r.toBlob(a=>i(a),`image/${n}`,e.quality))}async function en(t,e){const n=await ot(t,e),o=e.backgroundColor?mt(n,e.backgroundColor):n,r=new Image;return r.src=o.toDataURL(`image/${e.format}`,e.quality),await r.decode(),r.style.width=`${o.width/e.dpr}px`,r.style.height=`${o.height/e.dpr}px`,r}async function nn(t,e){if(e.format==="svg"){const i=await Tt(t,{...e,type:"svg"}),a=URL.createObjectURL(i),s=document.createElement("a");s.href=a,s.download=e.filename,s.click(),URL.revokeObjectURL(a);return}const n=await ot(t,e),o=e.backgroundColor?mt(n,e.backgroundColor):n,r=document.createElement("a");r.href=o.toDataURL(`image/${e.format}`,e.quality),r.download=e.filename,r.click()}var Ft=Symbol("snapdom.internal");async function P(t,e){if(!t)throw new Error("Element cannot be null or undefined");const n=Qe(e);return n.iconFonts&&n.iconFonts.length>0&&xe(n.iconFonts),n.snap||(n.snap={toPng:(o,r)=>P.toPng(o,r),toImg:(o,r)=>P.toImg(o,r)}),P.capture(t,n,Ft)}P.capture=async(t,e,n)=>{if(n!==Ft)throw new Error("[snapdom.capture] is internal. Use snapdom(...) instead.");const o=await je(t,e),r=a=>({...e,...a||{}}),i=a=>s=>{const u=r({...s||{},format:a}),c=a==="jpeg"||a==="jpg",l=u.backgroundColor==null||u.backgroundColor==="transparent";return c&&l&&(u.backgroundColor="#ffffff"),en(o,u)};return{url:o,toRaw:()=>o,toImg:a=>tn(o,r(a)),toCanvas:a=>ot(o,r(a)),toBlob:a=>Tt(o,r(a)),toPng:i("png"),toJpg:i("jpeg"),toWebp:i("webp"),download:a=>nn(o,r(a))}};P.toRaw=(t,e)=>P(t,e).then(n=>n.toRaw());P.toImg=(t,e)=>P(t,e).then(n=>n.toImg());P.toCanvas=(t,e)=>P(t,e).then(n=>n.toCanvas());P.toBlob=(t,e)=>P(t,e).then(n=>n.toBlob());P.toPng=(t,e)=>P(t,{...e,format:"png"}).then(n=>n.toPng());P.toJpg=(t,e)=>P(t,{...e,format:"jpeg"}).then(n=>n.toJpg());P.toWebp=(t,e)=>P(t,{...e,format:"webp"}).then(n=>n.toWebp());P.download=(t,e)=>P(t,e).then(n=>n.download());const on=_t("body");document.addEventListener("click",async t=>{t.target.matches(".am-camera")&&await(await P(on,{embedFonts:!0})).download({format:"jpg",filename:"photo"})});
